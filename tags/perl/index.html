
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
  <title>Perl</title>
  <script src="http://tech.k-zak.com/bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="http://tech.k-zak.com/bower_components/iron-icons/iron-icons.html">
  <link rel="import" href="http://tech.k-zak.com/bower_components/paper-drawer-panel/paper-drawer-panel.html">
  <link rel="import" href="http://tech.k-zak.com/bower_components/paper-icon-button/paper-icon-button.html">
  <link rel="import" href="http://tech.k-zak.com/bower_components/paper-toolbar/paper-toolbar.html">
  <link rel="import" href="http://tech.k-zak.com/bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">
  <link rel="import" href="http://tech.k-zak.com/bower_components/paper-fab/paper-fab.html">
  <link rel="import" href="http://tech.k-zak.com/bower_components/paper-item/paper-item.html">
  <link rel="import" href="http://tech.k-zak.com/bower_components/paper-menu/paper-menu.html">
  <link rel="import" href="http://tech.k-zak.com/bower_components/iron-image/iron-image.html">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/default.min.css">
  <style is="custom-style">
    body {
      font-family: 'Roboto', sans-serif;
    }
    .nav {
      border-right: 1px solid #ccc;
    }
    
    paper-scroll-header-panel {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background-color: var(--paper-grey-200, #eee);
       
      --paper-scroll-header-panel-full-header: {
        background-image: url(http://tech.k-zak.com/images/cover.png);
      };
       
      --paper-scroll-header-panel-condensed-header: {
        background-image: url(http://tech.k-zak.com/images/cover.png);
      };
    }
    
    paper-toolbar {
       
      height: 256px;
      background-color: transparent;
    }
    .profile{
      width: 100%;
      padding-bottom: 20px;
    }
    .photo{
      margin: 20px;
      display: inline-block;
      height: 64px; width: 64px;
      border-radius: 50%;
    }
    .article{
      border: 1px solid #bebebe;
      padding: 16px;
      margin: 16px;
      border-radius: 5px;
      background-color: #fff;
    }
    .title{
      font-size: 22px;
      padding: 8px 0 16px;
    }
    .description{
      font-size: 16px;
      padding-bottom: 8px;
    }
    .author{
      font-size: 16px;
      padding-left: 20px;
      color: white;
    }
    .design{
      font-size: 14px;
    }
    .copyright{
      font-size: 16px;
    }
    paper-menu a {
      text-decoration: none;
      color: #212121;
    }
  </style>

</head>
<body>
  <paper-drawer-panel id="drawerPanel" responsive-width="1280px">
    <div class="nav scroll" drawer>
    
      <iron-image class="profile" sizing="cover" src="http://tech.k-zak.com/images/profile.png">
    
        
          <iron-image class="photo" sizing="cover" src="http://tech.k-zak.com/images/photo.png"></iron-image>
        
          <div class="author"></div>
      </iron-image>
      <paper-menu>
        <a href="http://tech.k-zak.com"><paper-item>
          <iron-icon icon="home"></iron-icon>　<div class="flex">Home</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
        <a href="http://tech.k-zak.com/categories/"><paper-item>
          <iron-icon icon="drafts"></iron-icon>　<div class="flex">Categories</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
        <a href="http://tech.k-zak.com/tags/"><paper-item>
          <iron-icon icon="loyalty"></iron-icon>　<div class="flex">Tags</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
      </paper-menu>
    </div>

    <paper-scroll-header-panel main condenses header-height="256" condensed-header-height="64">

      <paper-toolbar>

        <paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
        <div class="bottom title">開発メモてきな</div>
        <div class="flex"></div>
        
        
        
        
        
          <a href="http://tech.k-zak.com/index.xml"><paper-icon-button src="http://tech.k-zak.com/images/feed-dreamstale27.png"></paper-icon-button></a>
      
      </paper-toolbar>



<div class="content">


  <div class="article">
    <div class="title"><a href="http://tech.k-zak.com/2015/02/16/challenge-fmxj">fmxj.js のサーバーサイドをPHPじゃなくてPerl(Mojolicious)で試す</a></div>
    
      <div class="categories">
        
          <a href="http://tech.k-zak.com/categories/study-daily/">study-daily</a>
        
          <a href="http://tech.k-zak.com/categories/setting-construction/">setting-construction</a>
        
      </div>
     
    <div class="description">先日、SeedCodeの方がFileMakerのCustom Web Publishing の為のJavaScriptとServer side で使うPHPのサンプルをGithubで公開されてました。
https://github.com/seedcode/fmxj
概要としては、FileMaker Server の XML公開を使う。
Web公開エンジンにXML公開のためのリクエストをJavaScriptで生成してサーバーサイドスクリプト(SeedCodeのサンプルではPHP)にpostする。
◆ハマった事：サンプルPHPの内容
サンプルのPHPをよく読んでなかった。。。
JavaScriptからFileMakerのユーザーアカウントとパスワードをpost出来るようにキーバリューを元々のpostデータに加えている。それから本来のpostデータからおまけを除くための追加分のパラメータ文字数もpostに加えている。この辺りの仕様にもんりょりする。
-db=dbname&amp;-lay=layname&amp;-query=(q1)&amp;-q1=Status&amp;-q1.value=Vendor&amp;-findquery みたいな通常のクエリデータに
u=undefined&amp;p=undefined&amp;l=コンテンツの文字数
ていうのがくっついてPHPにpostされてくる。
それをPHP側でphp://inputでリクエストのボディを取得して余計なパラメータを削ってpostデータを作り直してcurl使ってPOSTしてた。
そこに気づかずperlで再現しようとした時にpostデータを丸投げしてエラーになってしまっていた。
なんでpostデータをわざわざこねくり回してるんだろう？て思ってた。
サンプルって事でいろいろハードコーディングされてるけど、気にしない。
◆ハマった：Nginxの設定
欲をかいてPerlでサーバーサイド書くにあたって、FastCGIでさらっと書くじゃなくてMojolicious使うことにしたら
WebServer→Nginxでバーチャルホスト(hoge.sample.comみたいな)とmorboで127.0.0.1:3000で動くMojoliciousになって、何が起きたかって言うとクロスドメインの問題が発生してしまい、エラーになる。
これについてはNginxの設定でproxy_passでMojoliciousにリクエストがリバースプロキシされるようにして解決。
しかしNginx、デフォルトではContent-Typeの書き換えができず、JavaScriptにレスポンスされるデータがXMLになっていなくて、意図する結果に終わらない。既にあるヘッダーに値を追加する処理を行ってしまう。
※Nginxで add_header Content-Type &#8216;application/xml&#8217;してもmime-typeの設定ファイルに追記しても
　Content-Type text/html;charset=UTF-8に application/xmlの値が追記されるだけになる。
その結果、fmxj.jsがXMLHttpRequestのresponseXMLに値がセットされない。そしてresponseXMLがあるの前提になっているXMLをパースする処理のところで結果が空欄になって処理が終わってしまう。
最初fmxj.js内部を書き換えて(responseTextをXMLに変換して)みたんだけど、コアのライブラリを触るのはよくないので、Nginxでちゃんとヘッダを書き換えられる方法を調べる、nginx-extrasを追加でインストールするとmore-set-headerというのが使えるようになり、ヘッダーの書き換えができるようになるとの事だったのでインストール。
自分はUbuntuの環境なので、
 sudo apt-get install nginx-extras
 後はNginxの設定ファイルに(厳密に言うとリクエストを受け付けるLocationディレクティブで)
more_set_headers &#8216;Content-Type: application/xml; charset=UTF8&#8217;;
を追記、more&#8230;がヘッダーの追記ではなく書き換えなのでcharsetも忘れずに書く！
これでようやく、Sample.html → fmxj.jsを使ってServerにpostリクエスト → 受けたリクエストをNginxがMojoliciousを動かしてるmorboにリバースプロキシ → MojoliciousがPOSTリクエスト受け取りXML公開のクエリパラメータ付きURLを生成して(生成しなおして)cURLをラップしたライブラリからPOST送信 → JavaScriptにレスポンスが返り、完成。
いろいろとしょーもないミスを沢山した。CGIでサクッと試すだけにしておけば今頃はPythonもRubyも試せてかもしれないのに、残念でした。</div>
    <div class="tags">
      16 Feb 2015
      
        
          <a href="http://tech.k-zak.com/tags/filemaker/">#FileMaker</a>
        
          <a href="http://tech.k-zak.com/tags/fmxj/">#fmxj</a>
        
          <a href="http://tech.k-zak.com/tags/javascript/">#JavaScript</a>
        
          <a href="http://tech.k-zak.com/tags/mojolicious/">#Mojolicious</a>
        
          <a href="http://tech.k-zak.com/tags/nginx/">#nginx</a>
        
          <a href="http://tech.k-zak.com/tags/perl/">#Perl</a>
        
          <a href="http://tech.k-zak.com/tags/php/">#PHP</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="http://tech.k-zak.com/2015/01/05/perl-cgi">Ubuntu14.04 LTS でNginx FasCGI Perl</a></div>
    
      <div class="categories">
        
          <a href="http://tech.k-zak.com/categories/study-daily/">study-daily</a>
        
          <a href="http://tech.k-zak.com/categories/setting-construction/">setting-construction</a>
        
      </div>
     
    <div class="description">古いPerlのサンプルを参考に復習したくなって、やむなく自分の開発環境にFastCGI環境をセットアップ
最初、コードが間違っているのに気づかず3日ほどあれこれ調べまわっても解決せず時間を浪費した。
502 bad gatewayのエラーでて、ログを見ると Cannot execute script って出てて、調べても分からんし、権限は間違ってるはず無いしでずっとつまずいてた。
結局、
sudo apt-get install fcgiwrap  ※もしかしたら libgcgi-perlも必要？でもなんか下記のfastcgi-wrapper.plを使う場合に必要なやつかも
/etc/init.d/fcgiwrap のFCGI_USERあたりを動かしたいユーザーやグループに変更。※お好みで
sudo sysv-rc-conf on fcgiwrap sudo service fcgiwrap start  でFastCGIが動くようになる。
最初、fastcgi-wrapper.plを使う場合を参考にしてたけど、
参考：http://ubuntu.flowconsult.at/linux/nginx-perl-fastcgi-installation-ubuntu-linux-14-04/
これだとなんかPerlのみっぽかったしTCPだったので、Unixソケットで通信にしたかったのとpythonやRubyでも動かしたかったのでfcgiwrapを使うようにした。
Nginxの設定はlocationディレクティブだけ抜粋すると
#拡張子が.plで終わるリクエストの場合 location ~ \.pl$ { try_files $uri = 404; gzip off; #インストールしたfcgiwrapのソケットファイルのパス fastcgi_pass unix:/var/run/fcgiwrap.socket; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; #/etc/nginx/fastcgi_paramsの内容を読み込む。 include fastcgi_params; }  で
sudo service nginx restart  これで適用にperl書いて(シェバンはもちろん#!/usr/bin/env perl ですよ)試したら動きました。
自分はplenvを使っているのですが、システムのperl読み込まれてライブラリねーぞゴルァなった事があった。謎。
plenvの場合、require syscall.ph とかあると駄目っぽい？
この記事書いてる時に見つけた他の方のWeb。先にここを見つけたかった。。。
参考：http://ekzemplaro.org/data_base/doc/web_server/nginx/</div>
    <div class="tags">
      5 Jan 2015
      
        
          <a href="http://tech.k-zak.com/tags/fastcgi/">#FastCGI</a>
        
          <a href="http://tech.k-zak.com/tags/nginx/">#nginx</a>
        
          <a href="http://tech.k-zak.com/tags/perl/">#Perl</a>
        
          <a href="http://tech.k-zak.com/tags/ubuntu/">#ubuntu</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="http://tech.k-zak.com/2014/12/30/milestone-serverside">2014年を振り返る サーバーサイドプログラミング</a></div>
    
      <div class="categories">
        
          <a href="http://tech.k-zak.com/categories/study-daily/">study-daily</a>
        
      </div>
     
    <div class="description">サーバーサイドプログラミング(Perl,PHP,Python,Ruby,etc&#8230;)について振り返る
まず、コンパイルする系の言語には全然手を出さなかったのでノーコメント。
Groovyはちょっとだけ久しぶりに触ったらバージョンが上がってて言語仕様変わってた箇所でトラブった。
Perl,Python,Rubyについては全然触れなくてフラストレーション。
PHPは少し触ってたけど、使用バージョンがPHP5.4→PHP5.5→PHP5.6といろいろ触ってその間の言語仕様の変更に惑わされたりした。
本当はテストコードがしっかり書けるようになりたかったけど、いろいろ自分が足りなくて駄目だった。
家にたまった古い書籍も含めて処分していきたいので2015年はバシバシコードを書捨てていきたい。
PHP7が来年だか再来年にリリースされることによって現場には相当バージョン違いのプロジェクトが出てしまうと思うので、できれば新規案件は
枯れたPerl5系かPython3系(サポートがだいぶ長引くことになった2系も場合によっては)でチャレンジしたい。
Rubyは&#8230;どうだろう。試しやプロトタイプにはいいのかも、ただしSinatra限定。ツールはRuby系が多いのでRubyでいろいろ学習してから他の言語のものを使うようにするといいのかもしれない。</div>
    <div class="tags">
      30 Dec 2014
      
        
          <a href="http://tech.k-zak.com/tags/groovy/">#Groovy</a>
        
          <a href="http://tech.k-zak.com/tags/perl/">#Perl</a>
        
          <a href="http://tech.k-zak.com/tags/php/">#PHP</a>
        
          <a href="http://tech.k-zak.com/tags/python/">#Python</a>
        
          <a href="http://tech.k-zak.com/tags/ruby/">#Ruby</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="http://tech.k-zak.com/2013/12/22/pascal-logic">パスカルのなんとか</a></div>
    
      <div class="categories">
        
          <a href="http://tech.k-zak.com/categories/study-daily/">study-daily</a>
        
      </div>
     
    <div class="description">今回は、パスカルの三角定理？みたいなやつ
PHPでは、
&lt;?php $num = trim(fgets(STDIN)); $num = ($num)?(int)$num:10; $arr = array(1); for($i=0;$i&lt;$num;$i++){ $len = count($arr); $tmp = array(1); for($j=0;$j&lt;$len-1;$j++){ array_push($tmp,$arr[$j]+$arr[$j+1]); } array_push($tmp,1); $arr = $tmp; echo join(',',$arr)."\n"; } ?&gt; Perlでは、
#!/usr/bin/perl use strict; use warnings; my $num = &lt;stdin; chomp($num); $num ||= 10; my @list = (1); for(my $i=0;$i&lt;$num;$i++){ my $len = @list; my @tmp = (1); for(my $j=0;$j&lt;$len-1;$j++){ push(@tmp,$list[$j]+$list[$j+1]); } push(@tmp,1); @list = @tmp; print join(',',@list)."\n"; } &lt;/stdin Pythonでは、</div>
    <div class="tags">
      22 Dec 2013
      
        
          <a href="http://tech.k-zak.com/tags/perl/">#Perl</a>
        
          <a href="http://tech.k-zak.com/tags/php/">#PHP</a>
        
          <a href="http://tech.k-zak.com/tags/python/">#Python</a>
        
          <a href="http://tech.k-zak.com/tags/ruby/">#Ruby</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="http://tech.k-zak.com/2013/12/08/coding-memo05">コーディングリハビリ06</a></div>
    
      <div class="categories">
        
          <a href="http://tech.k-zak.com/categories/study-daily/">study-daily</a>
        
      </div>
     
    <div class="description">リハビリその3
今回は、バブルソート
PHPでは、
&lt;?php $num = trim(fgets(STDIN)); $num = ($num)?(int)$num:10; $arr = array(1); for($i=0;$i&lt;$num;$i++){ $len = count($arr); $tmp = array(1); for($j=0;$j&lt;$len-1;$j++){ array_push($tmp,$arr[$j]+$arr[$j+1]); } array_push($tmp,1); $arr = $tmp; echo join(',',$arr)."\n"; } ?&gt; Perlでは、
#!/usr/bin/perl use strict; use warnings; my $num = &lt;STDIN&gt;; chomp($num); $num ||= 10; my @list = (1); for(my $i=0;$i&lt;$num;$i++){ my $len = @list; my @tmp = (1); for(my $j=0;$j&lt;$len-1;$j++){ push(@tmp,$list[$j]+$list[$j+1]); } push(@tmp,1); @list = @tmp; print join(',',@list)."\n"; }  Pythonでは、</div>
    <div class="tags">
      8 Dec 2013
      
        
          <a href="http://tech.k-zak.com/tags/perl/">#Perl</a>
        
          <a href="http://tech.k-zak.com/tags/php/">#PHP</a>
        
          <a href="http://tech.k-zak.com/tags/python/">#Python</a>
        
          <a href="http://tech.k-zak.com/tags/ruby/">#Ruby</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="http://tech.k-zak.com/2013/12/08/coding-memo05">コーディングリハビリ05</a></div>
    
      <div class="categories">
        
          <a href="http://tech.k-zak.com/categories/study-daily/">study-daily</a>
        
      </div>
     
    <div class="description">昨日の文字チェックをPHP以外で試す。
与えられた文字列が全てユニークな文字で構成されているかのチェック。
PHPは前回やっているので、今回は掲載無し。
Perlでは、
#!/usr/bin/perl use strict; use warnings; sub check_unique{ my $str = shift; my $len = length($str); for(my $i=0;$i&lt;$len;$i++){ my $char = substr($str,$i); if(index($str,$char) != rindex($str,$char)){ return "False"; } } return "True"; } my $input = '1234567890-=\`!@#$%^&*()_+|~qwertyuiop[]QWERTYUIOP{}ASDFGHJKL:"asdfghjkl;\'zxcvbnm,./ZXCVBNM&lt;&gt;?'; #my $input = &lt;STDIN&gt;; #chomp($input); print check_unique($input)."\n"; Pythonでは、
#!/usr/bin/python #--*-- coding: utf-8 --*-- import datetime def check_unique(str): set_str = set(list(str)) if len(str) == len(set_str): return True else: return False if __name__ == "</div>
    <div class="tags">
      8 Dec 2013
      
        
          <a href="http://tech.k-zak.com/tags/perl/">#Perl</a>
        
          <a href="http://tech.k-zak.com/tags/python/">#Python</a>
        
          <a href="http://tech.k-zak.com/tags/ruby/">#Ruby</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="http://tech.k-zak.com/2013/12/06/coding-memo03">コーディングリハビリ03</a></div>
    
      <div class="categories">
        
          <a href="http://tech.k-zak.com/categories/study-daily/">study-daily</a>
        
      </div>
     
    <div class="description">リハビリその3
今回は、バブルソート
PHPでは、
&lt;?php function bubble_sort(array $arr,$r){ if(1 == $r){ return $arr; } $len = count($arr)-1; for($i=0;$i&lt;$len;$i++){ if($arr[$i] &gt; $arr[$i+1]){ $tmp = $arr[$i+1]; $arr[$i+1] = $arr[$i]; $arr[$i] = $tmp; } } return bubble_sort($arr,$r-1); } $input = trim(fgets(STDIN)); $arr = explode(",",$input); echo implode(",",bubble_sort($arr,count($arr)))."\n"; ?&gt; Perlでは、
#!/usr/bin/perl use strict; use warnings; sub bubble_sort{ my($arr,$r) = @_; my @arr = @{$arr}; if(1 == $r){ return @arr; }else{ my $len = @arr; for(my $i=0;$i&lt;$len-1;$i++){ if($arr[$i] &gt; $arr[$i+1]){ my $tmp = $arr[$i+1]; $arr[$i+1] = $arr[$i]; $arr[$i] = $tmp; } } bubble_sort(\@arr,$r-1) } } my $input = &lt;STDIN&gt;; chomp($input); my @arr = split(',',$input); print join("</div>
    <div class="tags">
      6 Dec 2013
      
        
          <a href="http://tech.k-zak.com/tags/perl/">#Perl</a>
        
          <a href="http://tech.k-zak.com/tags/php/">#PHP</a>
        
          <a href="http://tech.k-zak.com/tags/python/">#Python</a>
        
          <a href="http://tech.k-zak.com/tags/ruby/">#Ruby</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="http://tech.k-zak.com/2013/12/06/coding-memo02">コーディングリハビリ02</a></div>
    
      <div class="categories">
        
          <a href="http://tech.k-zak.com/categories/study-daily/">study-daily</a>
        
      </div>
     
    <div class="description">リハビリその２
今回は、ファイル読み込みとその時の簡単な例外処理
読み込むテキストファイルの内容は以下の通り、
7 1000 1992 あ A 2000 2001 1900 16 12 400  PHPでは、
&lt;?php function isLeap($year=null){ if($year == null) return false; $intYear = (int)$year; if(0 != $intYear%4){ return false; }elseif(0 == $intYear%400){ return true; }elseif(0 == $intYear%100){ return false; }else{ return true; } } try{ if(!file_exists("leap.txt")){ throw new Exception("ファイルが見つかりません。"); } $fp = fopen("leap.txt","r"); $lines = fgets($fp); for($i=0;$i&lt;$lines;$i++){ $year = trim(fgets($fp)); printf("%s is%s a leap year\n", $year,((isLeap($year))?"":" not")); } fclose($fp); }catch(Exception $e){ echo $e-&gt;getMessage().</div>
    <div class="tags">
      6 Dec 2013
      
        
          <a href="http://tech.k-zak.com/tags/perl/">#Perl</a>
        
          <a href="http://tech.k-zak.com/tags/php/">#PHP</a>
        
          <a href="http://tech.k-zak.com/tags/python/">#Python</a>
        
          <a href="http://tech.k-zak.com/tags/ruby/">#Ruby</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="http://tech.k-zak.com/2013/12/06/coding-memo01">コーディングリハビリ01</a></div>
    
      <div class="categories">
        
          <a href="http://tech.k-zak.com/categories/study-daily/">study-daily</a>
        
      </div>
     
    <div class="description">一定時間未満の習得状態だと、日々使ってないとすぐ書けなくなりますね。プログラミング言語というのは。
paizaなんかの超初級問題も関数のリファレンスとか見ながらじゃないと全く解けない。
という事でリハビリ。
今回は標準入力。
PHPでは、
&lt;?php //標準入力をfgets関数で取得して前後の空白や改行文字を削り取る $input = trim(fgets(STDIN)); ?&gt; Perlでは、
use strict; use warnings; my $input = &lt;STDIN&gt;; #行末の改行文字を削る chomp($input); Pythonでは、
input = raw_input() #行末の改行文字とるのは厳密にはいろいろあるらしいので今回は無視 Rubyでは、
input = gets.chomp 標準入力が「gets」だけで取れるRubyはダンディ。</div>
    <div class="tags">
      6 Dec 2013
      
        
          <a href="http://tech.k-zak.com/tags/perl/">#Perl</a>
        
          <a href="http://tech.k-zak.com/tags/php/">#PHP</a>
        
          <a href="http://tech.k-zak.com/tags/python/">#Python</a>
        
          <a href="http://tech.k-zak.com/tags/ruby/">#Ruby</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="http://tech.k-zak.com/2013/01/20/study-perl">Perlの動作環境？について</a></div>
    
      <div class="categories">
        
          <a href="http://tech.k-zak.com/categories/study-daily/">study-daily</a>
        
          <a href="http://tech.k-zak.com/categories/setting-construction/">setting-construction</a>
        
      </div>
     
    <div class="description">長らく更新してませんでしたが、その間にFlask試したり、最近なんかは
ちょっとだけVisual C++を初心者本見ながら動かしてました。
C++分かんない。
さて、PerlをVPS上で動かす＆Mojolicious::Liteで作成中の簡単なFAQアプリの為、Perlを
どうやって動かすのか、簡単に試したのでまとめてみた。(まとまってないし解説にもなってない)
perlを使えるように設定する
１，Perlを入れましょう。既に入っている場合はバージョンを確認してできるだけ偶数ナンバーの最新版を入れましょう
※奇数番号のバージョンは実験要素が強いと聞いたことがありますのでperl-14.xが良いかと
※perl -v でバージョンの確認ができます。
２，Perlbrewを入れましょうバージョンを切り替えたりライブラリを追加したりが楽になるそうです。
３，ターミナルベースで動かす
ファイルの拡張子を「.pl」とかにして内容はprint &#8220;Hello,World\n&#8221;;とか書いて
ターミナルで「perl aaa.pl」とかやると起動して処理実行しますね。
厳密にはファイルエンコードはUTF-8にしましょうとか、ソースの行頭にお決まりの書き方をするとかありますけど
その内容については省略するので他で調べてください。
４，ApacheにCGIの設定して動かす
特になんの設定もせずPerlファイルをWeb公開領域に置いてもソースをそのまま画面に出力したり、
エラーになったりします。
・ApacheにCGIの設定を書いていない
・作成したPerlファイルに実行権限がついていない
などが主な理由です。権限についてはchmodコマンドで実行権限を付与してください。
Apacheの設定ファイル「httpd.conf」もしくはVirtual-Hostの設定をしているなら「httpd-vhost.conf」を
開いて設定を記述します。
&#8212;&#8212;&#8212;-
AddHandler cgi-script .cgi .pl .py .rb
Options All
AllowOverride All
Order allow,deny
Allow from all

&#8212;&#8212;&#8212;-
こんな感じで。「AddHandler cgi-script」に対象拡張子を連ねる感じで記述すると動くようになります。
※当然LoadModuleのところでmod_cgiを読み込んでいるのが前提です。
※上の例では、Perl以外にもRubyやPythonもCGiで動く設定にしてますのん。
５，Apacheにmod_perlの設定をして動かす
まず自分の使っているApacheの拡張モジュール置き場にmod_perl.soがいる確認。自分の場合はMBP 10.8の
組込み?のApacheを使っているので/usr/libexec/apache2/mod_perl.soを確認。いた!
所定の場所にファイルがない人は別途調べてファイルを入手なりコンパイルなりしてください。
※ URL:http://perl.apache.org/download/index.html
・httpd.confのLoadModuleが沢山記述されているあたりの最後尾に「LoadModule perl_module /usr/libexec/apache2/mod_perl.so」
を追記
・適当なとこに下記の記述※自分の場合は上記のvirtualhostディレクトリ内に追記
・上記の設定で既に普通のCGIでPerlが動くようになってしまっているのでPerl関係拡張子を除外しておくこと!
&#8212;&#8212;&#8212;-
SetHandler perl-script
PerlHandler ModPerl::Registry
# Options +ExecCGII</div>
    <div class="tags">
      20 Jan 2013
      
        
          <a href="http://tech.k-zak.com/tags/perl/">#Perl</a>
        
       
    </div>
  </div>

</div>


<paper-item>
  
    <paper-fab disabled icon="chevron-left"></paper-fab>
  
    <div class="flex"></div>
  
    <a href="http://tech.k-zak.com/tags/perl/page/2/"><paper-fab icon="chevron-right"></paper-fab></a>
  
</paper-item>


      <paper-item>
        <div class="copyright"></div>
        <div class="flex"></div>
        <div class="design">Design <a href="http://pdevty.github.io/blog/">pdevty</a></div>
      </paper-item>
    </paper-scroll-header-panel>
  </paper-drawer-panel>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-46285513-1', 'auto');
    ga('send', 'pageview');
  </script>
  
</body>
</html>

