<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>未分類 on 開発メモてきな</title>
    <link>http://tech.k-zak.com/categories/%E6%9C%AA%E5%88%86%E9%A1%9E/index.xml</link>
    <description>Recent content in 未分類 on 開発メモてきな</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <atom:link href="http://tech.k-zak.com/categories/%E6%9C%AA%E5%88%86%E9%A1%9E/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Ubuntu14.04 でphpでメール受信とか</title>
      <link>http://tech.k-zak.com/ubuntu14-04-%E3%81%A7php%E3%81%A7%E3%83%A1%E3%83%BC%E3%83%AB%E5%8F%97%E4%BF%A1%E3%81%A8%E3%81%8B.html</link>
      <pubDate>Sun, 01 Feb 2015 14:51:57 +0000</pubDate>
      
      <guid>http://tech.k-zak.com/ubuntu14-04-%E3%81%A7php%E3%81%A7%E3%83%A1%E3%83%BC%E3%83%AB%E5%8F%97%E4%BF%A1%E3%81%A8%E3%81%8B.html</guid>
      <description>&lt;p&gt;## install postfix&lt;/p&gt;

&lt;p&gt;&amp;#8220;`&lt;/p&gt;

&lt;p&gt;sudo apt-get install postfix postfix-dev sasl2-bin&lt;/p&gt;

&lt;p&gt;sudo apt-get install dovecot-core dovecot-dev dovecot-pop3d dovecot-imapd dovecot-gssapt&lt;/p&gt;

&lt;p&gt;&amp;#8220;`&lt;/p&gt;

&lt;p&gt;## Settings&lt;/p&gt;

&lt;p&gt;&amp;#8220;`&lt;/p&gt;

&lt;p&gt;sudo cp /usr/lib/postfix/main.cf /etc/postfix/main.cf&lt;/p&gt;

&lt;p&gt;sudo emacs -nw /etc/postfix/main.cf&lt;/p&gt;

&lt;p&gt;&amp;#8220;`&lt;/p&gt;

&lt;p&gt;### 参考&lt;/p&gt;

&lt;p&gt;&amp;#8211; &lt;a href=&#34;http://www.server-world.info/query?os=Ubuntu_14.04&amp;amp;p=mail&#34;&gt;http://www.server-world.info/query?os=Ubuntu_14.04&amp;amp;p=mail&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&amp;#8211; &lt;a href=&#34;http://www.server-world.info/query?os=Ubuntu_14.04&amp;amp;p=mail&amp;amp;f=2&#34;&gt;http://www.server-world.info/query?os=Ubuntu_14.04&amp;amp;p=mail&amp;amp;f=2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;### gmailに転送する設定に変更&lt;/p&gt;

&lt;p&gt;relayhostにgmailを指定&lt;/p&gt;

&lt;p&gt;パスワードの設定とかね。&lt;/p&gt;

&lt;p&gt;## phpでメールを受信出来るよう設定&lt;/p&gt;

&lt;p&gt;メールサーバ受信DNS設定とか面倒だからやめた。&lt;/p&gt;

&lt;p&gt;phpinfoを見ると案の定imap入ってませんでしたので、php5.5系の落としてきてimapのディレクトリ移動してphpize&lt;/p&gt;

&lt;p&gt;### configureで失敗する&lt;/p&gt;

&lt;p&gt;configureしたらutf8_mime2text()がうんたらと出てきた。&lt;/p&gt;

&lt;p&gt;ググると、どうもphpにimapとかメール関係入れる時にライブラリが足りないと出るエラーのようだ。&lt;/p&gt;

&lt;p&gt;sudo apt-cache search libc-client&lt;/p&gt;

&lt;p&gt;→libc-client2007e libc-client2007e-dev てのが出てくるので両方インストール&lt;/p&gt;

&lt;p&gt;### imapうまく動かない？&lt;/p&gt;

&lt;p&gt;この後無事imapインストールできたけどなぜか受信出来ない。いろいろ調べて片っ端からSSL関連インストールしたけどうまくいかない。&lt;/p&gt;

&lt;p&gt;### 何が原因だったのか不明&lt;/p&gt;

&lt;p&gt;結局、何かのSSL関係のライブラリインストールが最初足りなくてGmail受信失敗してた。&lt;/p&gt;

&lt;p&gt;gmailからさくらのレンサバのメールアカウントで試した場合はアカウント名の指定を間違えてた。&lt;/p&gt;

&lt;p&gt;テストで受信するだけだから、普通のimapアカウントの場合はnotlsをflagにつける。&lt;/p&gt;

&lt;p&gt;gmailの場合は/ssl/novalidation-certみたいのつける&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Vagrant、最終的にはEC2にAnsibleでWordPressを構築を試みる2</title>
      <link>http://tech.k-zak.com/vagrant%E6%9C%80%E7%B5%82%E7%9A%84%E3%81%AB%E3%81%AFec2%E3%81%ABansible%E3%81%A7wordpress%E3%82%92%E6%A7%8B%E7%AF%89%E3%82%92%E8%A9%A6%E3%81%BF%E3%82%8B2.html</link>
      <pubDate>Sun, 07 Sep 2014 17:28:17 +0000</pubDate>
      
      <guid>http://tech.k-zak.com/vagrant%E6%9C%80%E7%B5%82%E7%9A%84%E3%81%AB%E3%81%AFec2%E3%81%ABansible%E3%81%A7wordpress%E3%82%92%E6%A7%8B%E7%AF%89%E3%82%92%E8%A9%A6%E3%81%BF%E3%82%8B2.html</guid>
      <description>&lt;p&gt;・botoが使えないってエラーになる。&lt;/p&gt;

&lt;p&gt;　→次のURLで解決 &lt;a href=&#34;https://groups.google.com/forum/#!topic/ansible-project/ftlmfIC1DHk&#34;&gt;https://groups.google.com/forum/#!topic/ansible-project/ftlmfIC1DHk&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;つまり、ansibleがなぜか現在動いているバージョンのライブラリを参照出来ないっぽいのでこれまたなぜか&lt;/p&gt;

&lt;p&gt;　　hostsにどこのpythonを使っているのか書いてあげる必要があったということ。なぜansible.cfgではないのか&lt;/p&gt;

&lt;p&gt;・契約アカウント？で試してたらCredentialエラーが出てて、試しにIAMアカウント作成してそのIAMアカウントを&lt;/p&gt;

&lt;p&gt;　使ったら成功した。なんで？&lt;/p&gt;

&lt;p&gt;・ApacheのVHOSTのRootディレクトリが700だったので403エラーで表示されなかった。755に変更して解決。&lt;/p&gt;

&lt;p&gt;・VirtualHostの設定を行う場合、どこかに「NameVirtualHost」の記述が必要。&lt;/p&gt;

&lt;p&gt;　というより、NameVirtualHostの記述内容とその後のVirtualHostディレクティブの内容に整合性がないといけない。&lt;/p&gt;

&lt;p&gt;　なので「NameVirtuakHost *:80」の記述があれば、その後&lt;virtualhost *:80&gt;VirtualHostディレクティブが&lt;/p&gt;

&lt;p&gt;　ないといけない。&lt;/p&gt;

&lt;p&gt;もしも&lt;/virtualhost&gt;&lt;virtualhost {{hostname}}:80&gt;みたいな記述をしていた場合、NameVirtualHost {{hostname}}:80の宣言もないといけない。&lt;/p&gt;

&lt;p&gt;整合性が撮れてないと、宣言が足りないとかそんなVirtualHostディレクティブはないとか警告が出る。&lt;/p&gt;

&lt;p&gt;・Ubuntuに入ってるApache2のVirtualHostの有効化無効化&lt;/p&gt;

&lt;p&gt;　sites-availableディレクトリにVirtualHost設定書く&lt;/p&gt;

&lt;p&gt;　a2ensite {{vhost_filename}} で有効化、a2dissite {{vhost_filename}} で無効化&lt;/p&gt;

&lt;p&gt;・Hostの指定が足りない！？&lt;/p&gt;

&lt;p&gt;Could not reliably determine the server&amp;#8217;s fully qualified domain name, using for ServerName&lt;/p&gt;

&lt;p&gt;こんなエラーが出る。hostsファイルに127.0.1.1 にhogehoge.localを追記してあげたら直った&lt;/p&gt;

&lt;p&gt;　つまり、hostsファイルにhostnameが127.0.1.1で定義されている場合、Apacheが名前解決のエラー出すので、&lt;/p&gt;

&lt;p&gt;　そこに{{hostname}}.localを追記する処理追加&lt;/p&gt;

&lt;p&gt;・Ansible用MySQLの設定追加&lt;/p&gt;

&lt;p&gt;Ansibleでmysql_userモジュールを使ってユーザーを追加する際に、MySQLが外部サーバーの場合は(Webサーバーから接続用ユーザーの作成の場合は)&lt;/p&gt;

&lt;p&gt;host=%,host=localhostの記述が必要、同時に作れるのか試してない。自分は別のtaskとしてそれぞれ実行(同じユーザー名で別hostのユーザーを2回作成)&lt;/p&gt;

&lt;p&gt;リモートユーザーにあたる側(今回はWebサーバー側)にはmysql_clientのインストールが必要&lt;/p&gt;

&lt;p&gt;・netstat -ant で現在使ってるポートとか観れる&lt;/p&gt;

&lt;p&gt;　(適当な解釈、後で意味をちゃんと調べる&amp;#8230;かも)&lt;/p&gt;

&lt;p&gt;・MySQLが外部からつながらぬ&lt;/p&gt;

&lt;p&gt;webとdbをVagrantで分けて作ったら、mysqlコマンドではwebサーバーから接続できるのに、PHPからだと駄目っぽい。&lt;/p&gt;

&lt;p&gt;my.cnfの[mysqld]のところに「skip-name-resolve」を追加した。&lt;/p&gt;

&lt;p&gt;これは、名前の解決をしないという設定。Vagrantでプライベートネットワークでやっているので、IP直接指定で行っているのでこれでいいや。&lt;/p&gt;

&lt;p&gt;・ApacheのRewriteの設定漏れ&lt;/p&gt;

&lt;p&gt;UbuntuのApache2.2でRewriteをa2enmodで使えるようにしたはずなのに、動かないな〜って思ってたら、confの設定漏れてた。&lt;/p&gt;

&lt;p&gt;　AllowOverride をAllにしなかった。。。&lt;/p&gt;

&lt;p&gt;ということで？今のところ、Vagrantで作成したVMにMySQLやApacheの設定、それからWordPressの設置は出来るように&lt;/p&gt;

&lt;p&gt;なりました。&lt;/p&gt;

&lt;p&gt;それとEC2インスタンスを作成することもできた。合わせ技は&amp;#8230;別々に動かせばよくね？という事で今回のテーマはここまで。&lt;/p&gt;

&lt;p&gt;&lt;/virtualhost&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>